<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Firebase iOS ë””ë²„ê·¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>
  <h2>ğŸ“¡ Firebase ë””ë²„ê¹… ì½˜ì†”</h2>
  <pre id="log" style="white-space: pre-wrap; background: #eee; padding: 1em;"></pre>

  <!-- Firebase SDK -->
  <script type="module">
    const log = (msg) => {
      const el = document.getElementById("log");
      el.textContent += msg + '\n';
      console.log(msg);
    };

    log("âœ… ë””ë²„ê·¸ ì‹œì‘");

    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-database.js";

    // âœ… 1. Firebase config ì…ë ¥
    const firebaseConfig = {
        apiKey: "AIzaSyA_x42u5N0cgcL4UZg72eWHho5oi3Nx1Tw",
        authDomain: "healing-space-22fcc.firebaseapp.com",
        databaseURL: "https://healing-space-22fcc-default-rtdb.firebaseio.com",
        projectId: "healing-space-22fcc",
        storageBucket: "healing-space-22fcc.firebasestorage.app",
        messagingSenderId: "748135616885",
        appId: "1:748135616885:web:b35bc65e64b618ad3b033c",
    };

    log("ğŸ”§ Firebase ì´ˆê¸°í™” ì‹œë„");
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // âœ… 2. WebSocket ì‹¤íŒ¨ ê¸°ë¡ ì œê±°
    localStorage.removeItem("firebase:previous_websocket_failure");
    log("ğŸ§¹ WebSocket ì‹¤íŒ¨ í”Œë˜ê·¸ ì œê±° ì™„ë£Œ");

    // âœ… 3. ì‹¤ì‹œê°„ ë°ì´í„° ë¦¬ìŠ¤ë„ˆ ë“±ë¡
    const reservationsRef = ref(db, "reservations");

    onValue(reservationsRef, (snapshot) => {
      const data = snapshot.val();
      log("ğŸ“¥ ë°ì´í„° ìˆ˜ì‹  ì„±ê³µ!");
      log(JSON.stringify(data, null, 2));
    }, (error) => {
      log("âŒ ë°ì´í„° ìˆ˜ì‹  ì‹¤íŒ¨: " + error.code);
    });

    // âœ… 4. ë„¤íŠ¸ì›Œí¬ ë³µê·€ ì‹œ ì¬ë“±ë¡
    window.addEventListener("online", () => {
      localStorage.removeItem("firebase:previous_websocket_failure");
      log("ğŸ”„ ì˜¨ë¼ì¸ ë³µê·€ - í”Œë˜ê·¸ ì œê±°");
    });
  </script>
</body>
</html>
